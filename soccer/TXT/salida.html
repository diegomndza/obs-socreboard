<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>
<link rel="preload" as="image" href="../stats.png"/>
<link rel="preload" as="image" href="../stats.png"/>
<title>Marcador</title>
<style>
:root{
  --bug-scale: 1.00;
  --mid-w: 950px;
  --mid-w-expanded: 1250px;
  --left-w: 300px;
  --right-w: 36px;
  --canvas-width: 1920px;
  --canvas-height: 1080px;
  --scorebug-top: 24px;
  --scorebug-left: 24px;
  --color-local: #FF0000;
  --color-visita: #FF9800;
  --color-text-local: #ffffff;
  --color-text-visita: #000000;
}
html,body{ margin:0; padding:0; width:var(--canvas-width); height:var(--canvas-height);
  background-color:rgba(0,0,0,0)!important; overflow:hidden; font-family:'Inter','SF Pro Display','Segoe UI',Arial,sans-serif; color:#111; }
.stage{ position:relative; width:var(--canvas-width); height:var(--canvas-height); }
#bug-wrap{ position:absolute; top:var(--scorebug-top); left:var(--scorebug-left); transform:scale(var(--bug-scale)); transform-origin:top left;
  filter:drop-shadow(0 12px 28px rgba(0,0,0,.35)); }
#ea-scorebug{ display:flex; align-items:stretch; transition:width .70s cubic-bezier(.2,.7,.2,1); }

/* IZQUIERDA */
.ea-left{ display:flex; flex-direction:column; width:var(--left-w); }
.ea-tri,.ea-comp,.ea-time,.time-extra{ width:var(--left-w); box-sizing:border-box; }
.ea-tri{ height:110px; background:#111; border-top-left-radius:10px; display:flex; align-items:center; justify-content:center; overflow:hidden; }
.ea-tri img{ max-width: calc(var(--left-w) - 20px); max-height: 96px; width:auto; height:auto; object-fit:contain; }
.ea-comp{ background:#111; color:#fff; font-weight:900; font-size:28px; letter-spacing:.7px; padding:16px 18px; border-bottom:1px solid rgba(255,255,255,.08);}
.ea-time{ background:#2FE05B; color:#000; font-weight:900; font-size:64px; padding:18px 24px; line-height:1; display:flex; align-items:center; justify-content:center; }
.time-extra{ background:#2FE05B; color:#000; font-weight:900; font-size:56px; line-height:1; padding:0 18px; overflow:hidden; max-height:0; width:var(--left-w);
  transition:max-height .70s cubic-bezier(.2,.7,.2,1), padding .70s cubic-bezier(.2,.7,.2,1); border-bottom-left-radius:10px; }
.time-extra.show{ max-height:56px; padding:10px 18px; }

/* EXPANDER */
#bug-outer{ display:inline-block; width:auto; }
#expander{
  width:100%;
  background:#fff; color:#111;
  border-radius:0 0 10px 10px;
  overflow:hidden;
  box-shadow:0 10px 24px rgba(0,0,0,.20);
  max-height:0;
  transition:max-height .45s ease;
  will-change:max-height;
}
#expander.open{ max-height:460px; }
/* El panel usa el ancho del bug expandido */
.panel-lg{ width: calc(var(--left-w) + var(--mid-w-expanded) + var(--right-w)); max-width: calc(var(--left-w) + var(--mid-w-expanded) + var(--right-w)); padding: 22px 24px; } 
#expander .panel{ background:#fff; color:#111; }

/* CENTRO */
.ea-mid{ background:#fff; color:#111; display:flex; flex-direction:column; padding:20px 24px; row-gap:16px; 
  width:var(--mid-w); transition:width .70s cubic-bezier(.2,.7,.2,1); box-sizing:border-box; 
  border-top-right-radius: 0; border-bottom-right-radius: 0; } 

#ea-scorebug.expanded .ea-mid{ width:var(--mid-w-expanded); }
#ea-scorebug.expanded .ea-time{ font-size:74px; padding:22px 28px; }
#ea-scorebug.expanded .ea-mid .name{ font-size:72px; }
#ea-scorebug.expanded .ea-mid .score{ font-size:104px; }

.ea-mid .row{ 
    display:grid; 
    grid-template-columns: 180px 48px 1fr minmax(100px, auto); 
    align-items:center; 
    column-gap:22px; 
}
.ea-mid .name{ font-weight:900; font-size:64px; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; min-width:300px; } 
.ea-mid .score{ font-weight:900; font-size:96px; text-align:right; min-width:100px; color:#111; }

.crest{ width:180px; height:180px; object-fit:contain; display:block; }
.reds{ display:flex; gap:8px; justify-content:flex-start; align-items: center; }
.rc{ width:40px; height:44px; background:#D32F2F; border-radius:6px; }

/* DERECHA */
.ea-right{ display:flex; flex-direction:column; width: var(--right-w); min-width: var(--right-w); border-top-right-radius:10px; border-bottom-right-radius:10px; overflow:hidden; }
.right-row{ flex:1 1 auto; }
.right-row.local{ background: var(--color-local); }
.right-row.visita{ background: var(--color-visita); }

/* Paneles grandes - Overlays */
.panel{ background:rgba(0,0,0,.92); border-radius:14px; padding:22px 24px; display:flex; align-items:center; gap:18px; box-shadow:0 10px 24px rgba(0,0,0,.35); margin:14px; font-size:22px; }
.panel .chip{ font-weight:900; padding:10px 16px; border-radius:10px; letter-spacing:.6px; text-transform:uppercase; }
.panel .line{ display:flex; align-items:center; gap:24px; flex-wrap:wrap; }
.team-long{ padding:6px 12px; border-radius:8px; font-weight:900; font-size:32px; }
.score-big{ font-weight:900; font-size:100px; }
.player-big{ font-weight:800; font-size:48px; }
.num-big{ font-weight:900; font-size:44px; min-width:48px; text-align:right; }
.pname-big{ font-weight:800; font-size:44px; }

/* STATS */
.stats-icon{ width:200px; height:200px; object-fit:contain; display:inline-block; margin-left: 24px; }
.stats-content{ flex-grow: 1; display:flex; flex-direction: column; }
#stats .stats-track{ flex:1 1 auto; height:44px; border-radius:12px; overflow:hidden; display:flex; margin:12px 0; background:#fff; border:1px solid rgba(0,0,0,.08); } 
#stats .seg{ display:flex; align-items:center; justify-content:center; font-weight:900; line-height:1; font-size:26px; } 
#stats .seg.local{ background: var(--color-local); color: var(--color-text-local); }
#stats .seg.visita{ background: var(--color-visita); color: var(--color-text-visita); }
.stats-wrap{ display:flex; align-items:center; gap:18px; flex-grow: 1; }

/* Triángulos cambio */
.tri{ width:0; height:0; }
.tri-left{ border-top:10px solid transparent; border-bottom:10px solid transparent; border-right:16px solid #00e676; }
.tri-right{ border-top:10px solid transparent; border-bottom:10px solid transparent; border-left:16px solid #ff5252; }
.num-big.out{ color:#ff5252; }
</style>
</head>
<body>
<div class="stage">
  <div id="bug-wrap">
    <div id="bug-outer">
      <div id="ea-scorebug" class="">
        <div class="ea-left">
          <div class="ea-tri"><img id="brand" src="../stats.png" alt="Brand" onerror="this.style.display='none'"/></div>
          <div class="ea-comp">CONADEIP</div>
          <div class="ea-time"><span id="ea-clock">00:17</span></div>
          <div id="time-extra" class="time-extra"></div>
        </div>
        <div class="ea-mid">
          <div class="row">
            <img class='crest' src='../Copia de panteras-up.png' alt='' onerror="this.style.display='none'"/>
            <span class="reds" id="redsL"></span>
            <span class="name" id="teamL">UP AGS</span>
            <span class="score" id="scoreL">1</span>
          </div>
          <div class="row">
            <img class='crest' src='../Copia de leones-anahuac.png' alt='' onerror="this.style.display='none'"/>
            <span class="reds" id="redsR"></span>
            <span class="name" id="teamR">ANÁHUAC NTE</span>
            <span class="score" id="scoreR">0</span>
          </div>
        </div>
        <div class="ea-right">
          <div class="right-row local"></div>
          <div class="right-row visita"></div>
        </div>
      </div>
      <div id="expander" class=""><div id="expander-inner"></div></div>
    </div>
  </div>
</div>
<script>
async function updateScorebug(){
  try {
    const resp = await fetch('estado.json', {cache: 'no-store'});
    if (!resp.ok) return;
    const data = await resp.json();
    // actualizar reloj
    const clockEl = document.getElementById('ea-clock');
    if (clockEl && data.clock !== undefined) clockEl.textContent = data.clock;
    // extra time
    const timeExtra = document.getElementById('time-extra');
    if (timeExtra) {
      if (data.extra && data.extra > 0) {
        timeExtra.classList.add('show');
        timeExtra.textContent = '+'+data.extra+"'";
      } else {
        timeExtra.classList.remove('show');
        timeExtra.textContent = '';
      }
    }
    // nombres y marcadores
    const teamL = document.getElementById('teamL');
    const teamR = document.getElementById('teamR');
    const scoreL = document.getElementById('scoreL');
    const scoreR = document.getElementById('scoreR');
    if (teamL && data.teamL !== undefined) teamL.textContent = data.teamL;
    if (teamR && data.teamR !== undefined) teamR.textContent = data.teamR;
    if (scoreL && data.scoreL !== undefined) scoreL.textContent = data.scoreL;
    if (scoreR && data.scoreR !== undefined) scoreR.textContent = data.scoreR;
    // colores
    if (data.colorL) {
      document.documentElement.style.setProperty('--color-local', data.colorL);
    }
    if (data.colorR) {
      document.documentElement.style.setProperty('--color-visita', data.colorR);
    }
    if (data.colorTextL) {
      document.documentElement.style.setProperty('--color-text-local', data.colorTextL);
    }
    if (data.colorTextR) {
      document.documentElement.style.setProperty('--color-text-visita', data.colorTextR);
    }
    // tarjetas rojas
    const redsL = document.getElementById('redsL');
    const redsR = document.getElementById('redsR');
    if (redsL) {
      redsL.innerHTML = '';
      const n = data.redL || 0;
      for (let i=0; i<n; i++) {
        const span = document.createElement('span');
        span.className = 'rc';
        redsL.appendChild(span);
      }
    }
    if (redsR) {
      redsR.innerHTML = '';
      const n = data.redR || 0;
      for (let i=0; i<n; i++) {
        const span = document.createElement('span');
        span.className = 'rc';
        redsR.appendChild(span);
      }
    }
    // Overlay
    const expander = document.getElementById('expander');
    const scorebug = document.getElementById('ea-scorebug');
    const expInner = document.getElementById('expander-inner');
    if (expander && scorebug && expInner) {
      if (data.overlay_html) {
        expander.classList.add('open');
        scorebug.classList.add('expanded');
        expInner.innerHTML = data.overlay_html;
      } else {
        expander.classList.remove('open');
        scorebug.classList.remove('expanded');
        expInner.innerHTML = '';
      }
    }
  } catch (err) {
    // error silencioso
  }
}
setInterval(updateScorebug, 500);
updateScorebug();
</script>
</body>
</html>
